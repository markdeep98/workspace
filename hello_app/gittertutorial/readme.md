Пошаговая инструкция
======================================================================

В данной инструкции по шагам расписывается пример настройки [Gitter](https://bitbucket.org/rtnm/gitter "Переход к репозиторию Gitter") и всех вспомогательных компонентов.

**Замечание: Я нигде не заменяю имя своего пользователя - rtnm - будьте бдительны.**

Загрузка Git
----------------------------------------------------------------------

Заходим на [официальный сайт Git](http://git-scm.com/ "Официальный сайт Git") и скачиваем [последнюю версию git для windows](http://git-scm.com/download/win "последняя версия git для windows").

![Загрузка Git](http://rtnm.bitbucket.io/gitter/tutorial/1-1.png)

Установка Git
----------------------------------------------------------------------

Устанавливаем Git. Я у себя устанавливал так как показано ниже.

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-1.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-2.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-3.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-4.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-5.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-6.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-7.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-8.png)

![Установка Git](http://rtnm.bitbucket.io/gitter/tutorial/2-9.png)

Генерация SSH-ключей
----------------------------------------------------------------------

SSH-ключи потребуются при выгрузке локальных репозиториев в удаленные репозитории находящиеся на таких ресурсах как [Bitbucket](https://bitbucket.org/ "Сайт Bitbucket") или [Github](https://github.com/ "Сайт Github"). Для их генерации мы воспользуемся консольной утилитой входящей в дистрибутив Git.

Запускаем Git Bash

![Запуск Git Bash](http://rtnm.bitbucket.io/gitter/tutorial/3-1.png)

Выполняем команду `ssh-keygen`. На все дополнительные запросы ничего не вводим, просто нажимаем Enter.

![Генерация SSH-ключей](http://rtnm.bitbucket.io/gitter/tutorial/3-2.png)

После этого в каталоге `C:\Users\rtnm\.ssh` появятся 2 файла:

- `id_rsa` - закрытый ключ
- `id_rsa.pub` - открытый ключ

Регистрация на Bitbucket
----------------------------------------------------------------------	

Заходим на [Bitbucket](https://bitbucket.io/ "Сайт Bitbucket"). Сразу же предлагают зарегистрироваться. Указываем желаемый логин, email и пароль.

![Регистрируемся на Bitbucket](http://rtnm.bitbucket.io/gitter/tutorial/4-1.png)

Нажимаем `sign up for free`.

![Регистрируемся на Bitbucket](http://rtnm.bitbucket.io/gitter/tutorial/4-2.png)

Вводим свои персональные данные и нажимаем `Submit` или просто нажимаем `Skip`.

![Регистрируемся на Bitbucket](http://rtnm.bitbucket.io/gitter/tutorial/4-3.png)

Создание удаленного репозитория
----------------------------------------------------------------------

Созданим удаленный репозиторий в который будем выгружать созданный в будущем локальный репозиторий.

![Создание удаленного репозитория](http://rtnm.bitbucket.io/gitter/tutorial/5-1.png)

Нажимаем `Create` или `Create your first repository`.

![Создание удаленного репозитория](http://rtnm.bitbucket.io/gitter/tutorial/5-2.png)

Указываем имя нового репозитория и другие настройки. Нажимаем `Create repository`.

![Создание удаленного репозитория](http://rtnm.bitbucket.io/gitter/tutorial/5-3.png)

Настройка доступа к репозиториям по SSH
----------------------------------------------------------------------

Переходим к настройке учетной записи.

![Настройка доступа по SSH](http://rtnm.bitbucket.io/gitter/tutorial/6-1.png)

Нажимаем `Manage account`.

![Настройка доступа по SSH](http://rtnm.bitbucket.io/gitter/tutorial/6-2.png)

Переходим на закладку `SSH keys`.

![Настройка доступа по SSH](http://rtnm.bitbucket.io/gitter/tutorial/6-3.png)

Добавляем новый ключ, нажимая на кнопку `Add key`. Указываем имя ключа. Указываем сам ключ, скопировав содержимое файла `C:\Users\rtnm\.ssh\id_rsa.pub` открытого в любом текстовом редакторе.

![Настройка доступа по SSH](http://rtnm.bitbucket.io/gitter/tutorial/6-4.png)

Нажимаем `Add key`.

![Настройка доступа по SSH](http://rtnm.bitbucket.io/gitter/tutorial/6-5.png)

Создание демонстрационной конфигурации и хранилища
----------------------------------------------------------------------

- Создаем новую файловую базу в каталоге `C:\GitterTutorial\БазаDemo` на основе пустой конфигурации.
- Создаем для новой базы хранилище распологающееся в каталоге `C:\GitterTutorial\ХранилищеDemo`, выполнив действие `Конфигурация -> Хранилище конфигурации -> Создать хранилище...`, указав при этом администратором `Разработчик` с паролем `123`.
- Захватываем корень конфигурации, добавляем справочник `Справочник1`, помещаем изменения в хранилище с комментарием `Добавлен Справочник1`.
- Еще раз захватываем корень конфигурации, добавляем документ `Документ1`, помещаем изменения в хранилище с комментарием `Добавлен Документ1`.

Создание транзитной базы
----------------------------------------------------------------------

В данную базу будет загружаться очередная версия конфигурации из хранилища. Создайте новую файловую базу в каталоге `C:\GitterTutorial\ТранзитнаяБазаDemo` на основе пустой конфигурации. 

Создание и настройка базы Gitter
----------------------------------------------------------------------

- Создаем новую файловую базу в каталоге `C:\GitterTutorial\БазаGitter` на основе пустой конфигурации.
- Загружаем в новую базу конфигурацию Gitter.
- Запускаем базу Gitter в режиме 1С:Предприятие.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-1.png)

Создаем новую запись справочника `Хранилища`, указываем наименование, путь до хранилища и пользователя под которым будет происходить подключение.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-2.png)

Указываем размещение транзитной базы, пользователь и пароль указывать не надо.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-3.png)

Создаем каталог `C:\GitterTutorial\РепозиторийDemo `, в нем будет располагаться локальный репозиторий Git с выгруженной конфигурацией.

Подглядываем адрес удаленного репозитория, в нашем случае это `git@bitbucket.org:gittertutorial/repo.git`.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-4.png)

Указываем репозитории в настройках.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-5.png)

Указываем используемое приложение 1С, и количество версий выгружаемых за раз.

![Настройка Gitter](http://rtnm.bitbucket.io/gitter/tutorial/8-6.png)

Записываем новую запись справочника `Хранилища`.

Инициализация локального репозитория
----------------------------------------------------------------------

Выполняем действие `Инициировать локальный репозиторий`.

Загрузка пользователей хранилища
----------------------------------------------------------------------

Выполняем действие `Загрузить пользователей хранилища `.

![Загрузка пользователей хранилища](http://rtnm.bitbucket.io/gitter/tutorial/10-1.png)

Проставляем каждому пользователю хранилища email.

![Загрузка пользователей хранилища](http://rtnm.bitbucket.io/gitter/tutorial/10-2.png)

Выгрузка версий конфигураций хранилища в репозитории Git
----------------------------------------------------------------------

Выполняем действие `Выгрузить версии в репозитории`.

При первой выгрузке в удаленный репозиторий подтверждаем что хотим установить соединение с bitbucket.org. Пишем `yes`.

![Выгрузка в репозитории Git](http://rtnm.bitbucket.io/gitter/tutorial/11-1.png)

Проверяем версии конфигураций хранилища, там должно быть несколько записей.

![Выгрузка в репозитории Git](http://rtnm.bitbucket.io/gitter/tutorial/11-2.png)

Убеждаемся что в удаленом репозитории появились данные.

![Выгрузка в репозитории Git](http://rtnm.bitbucket.io/gitter/tutorial/11-3.png)

Восстановление
----------------------------------------------------------------------

Давайте представим что было потеряно почти все: базы разработчиков, хранилище, локальный репозиторий. Остался лишь удаленный репозиторий.

Смоделируем эту ситуацию:

- Удаляем каталог C:\GitterTutorial\РепозиторийDemo и его содержимое
- Удаляем содержимое каталога C:\GitterTutorial\ХранилищеDemo
- Удаляем содержимое каталога C:\GitterTutorial\БазаDemo

Сначала восстановим локальный репозиторий. Для этого открываем командную строку.
Выполняем следующие команды.

    cd C:\GitterTutorial
    git clone git@bitbucket.org:gittertutorial/repo.git РепозиторийDemo

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-1.png)

- Создаем снова пустую конфигурацию в каталоге C:\GitterTutorial\БазаDemo.
- Открываем конфигуратор созданной базы и выполняем команду `Конфигурация -> Загрузить конфигурацию из файлов...` указывая в качестве каталога `C:\GitterTutorial\РепозиторийDemo\Конфигурация`.
- Создаем хранилище конфигурации в каталоге `C:\GitterTutorial\ХранилищеDemo ` выполняя команду `Конфигурация -> Хранилище конфигурации -> Создать хранилище...` и указывая в качестве администратора `Разработчик` с паролем `123`. 

Осталось немного перенастроить Gitter. Ранее было выгружено 3 версии.

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-2.png)

Текущая первая версия в хранилище соответствует третьей версии которая была раньше. Это значит что мы потеряли 2 версии. Указываем в настройках хранилища, что оно после восстановление и было потеряно 2 версии.

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-3.png)

Теперь можно проверить результат. Добавим еще 2 изменения: новый справочник и новый документ.

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-4.png)

Выполним в Gitter действие `Выгрузить версии в репозитории`. Проверим результат.

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-5.png)

![Восстановление](http://rtnm.bitbucket.io/gitter/tutorial/12-6.png)


















